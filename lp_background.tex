\documentclass{beamer}
%\documentclass[xcolor=pst,dvips,epic,eepic]{beamer}

\usepackage[utf8]{inputenc}
\usetheme{Singapore}
\usepackage{xcolor}
\setbeamertemplate{footline}[frame number]

%\usepackage{pgf,pgfarrows,pgfnodes,pgfautomata,pgfheaps,pgfshade}
%\usepackage[pst]{xcolor}
%\usepackage{xxcolor}
\usepackage{mathlist}

%\usepackage[frenchb]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath,amssymb,amsthm}

\newtheorem{theo}{Theorem}

\usepackage{pstricks}

%\usepackage{eepic}

\usepackage{times}

%\usepackage{pst-tree}

\usepackage{ulem}

\usepackage{listings}
%\topmargin=-0.6in
\lstloadlanguages{C++}
\lstset{language=C++}
%%}

\setbeamercovered{dynamic}

\def\bxi{\boldsymbol\xi}
\def\bomega{\boldsymbol\omega}
\def\bxi{\boldsymbol\xi}

\def\rit{\mathcal{R}}

\def\cF{\mathcal{F}}
\def\cK{\mathcal{K}}
\def\cB{\mathcal{B}}
\def\cQ{\mathcal{Q}}
\def\cR{\mathcal{R}}

\def\bb{\boldsymbol{b}}
\def\bc{\boldsymbol{c}}
\def\bx{\boldsymbol{x}}
\def\bA{\boldsymbol{A}}
\def\bB{\boldsymbol{B}}
\def\bD{\boldsymbol{D}}

\author[Fabian Bastin]{Fabian Bastin \\ \url{fabian.bastin@umontreal.ca} \\ Université de Montréal -- CIRRELT -- IVADO -- Fin-ML}
\date{}
\title[Linear programming]{Linear programming\\Background material}

\begin{document}

\frame{\titlepage}

\begin{frame}
\frametitle{Linear program}

Linear program, standard form:
\begin{align*}
\min_x c^Tx \\
\mbox{s.t. } Ax &= b,\\
x &\geq 0,
\end{align*}
with $x, c \in \rit^n$, $b \in \rit^m$, $A \in \rit^{m \times n}$.

\mbox{}

Assumptions: rank($A$) = $m$, $m \leq n$.
\end{frame}

\begin{frame}
\frametitle{Standard form}

Any linear program can be transformed to the standard form.
Consider for instance the program
\[
\min_x c^Tx \mbox{ s.t. } Ax \geq b.
\]
Note that there is no bound constraints on $x$.

\mbox{}

We first add a vector $z$ of surplus variables:
\begin{align*}
\min_x\ & c^Tx \\
\mbox{s.t. } & Ax - z = b,\\
& z \geq 0.
\end{align*}
We next decompose $x$ as the difference of two non-negative variables: $x = x^+-x^-$, where $x^+ = \max \lbrace x,
0 \rbrace \geq 0$, and $x^- = \max \lbrace -x, 0 \rbrace \geq 0$.
\end{frame}

\begin{frame}
\frametitle{Standard form (cont'd)}

The problem becomes
\begin{align*}
\min_x\ &
\begin{pmatrix}
c & -c & 0
\end{pmatrix}
\begin{pmatrix}
x^+ \\ x^- \\ z
\end{pmatrix}, \\
\mbox{ s.t. } &
\begin{pmatrix}
A & -A & -I
\end{pmatrix}
\begin{pmatrix}
x^+ \\ x^- \\ z
\end{pmatrix} = b,
\begin{pmatrix}
x^+ \\ x^- \\ z
\end{pmatrix} \geq 0.
\end{align*}

The inequalities constraints of the form $x \leq u$ or $Ax \leq b$ can be handled by adding slack variables:
\begin{align*}
x \leq u \Leftrightarrow x+w = u,\ w \geq 0, \\
Ax \leq b \Leftrightarrow Ax + y = b,\ y \geq 0. \\
\end{align*}

\end{frame}

\begin{frame}
	\frametitle{Basis solutions}

Without loss of generality, suppose that the first $m$ columns are independent, and form
	\[
	\bA =
	\begin{pmatrix}
		\bB & \bD
	\end{pmatrix}
	\]
	
	\mbox{}
	
	{\it Solution de base}: $\bx = (\bx_b \ 0)$, avec $\bB\bx_b = \bb$.\\
	{\it Solution de base dégénérée}: si $\bx_b$ contient des composantes nulles. \\
	{\it Solution de base réalisable}: solution de base telle que $\bA\bx = \bb$ et $\bx \geq 0$.

\end{frame}

\begin{frame}
	\frametitle{Théorème fondamental de la programmation linéaire}
	
	Soit un PL sous forme standard, avec $\bA$ de dimension $m \times n$ et de rang plein (i.e. rang($\bA$) = m).
	\begin{itemize}
		\item
		S'il y a une solution réalisable, alors il y a une solution de base réalisable.
		\item
		S'il y a une solution réalisable optimale, alors il y a une solution de base réalisable optimale.
	\end{itemize}

\end{frame}
\begin{frame}
	\frametitle{Dualité}
	
	Nous considérons le problème, dit {\bf primal}:
	\begin{align*}
		\min_x \ & c^T x \\
		\mbox{t.q. } & Ax \geq b \\
		& x \geq 0
	\end{align*}
	
	\mbox{}
	
	Le programme suivant est appelé {\bf dual}:
	\begin{align*}
		\max_{\lambda} \ & \lambda^T b \\
		\mbox{t.q. } & A^T \lambda \leq c \\
		& \lambda \geq 0
	\end{align*}
	$A \in \cR^{m \times n}$, $c, x, \in \cR^n$, $\lambda, b \in \cR^m$.
	
	Note: les contraintes duales peuvent aussi s'écrire $\lambda^T A \leq c^T$ (en appliquant l'opérateur de transposition de part et d'autre de l'inégalité).
	
\end{frame}

\begin{frame}
	\frametitle{Dualité}
	
	$x$: variables du problème primal\\
	$\lambda$: variables du problèmes dual
	
	\mbox{}
	
	Dual du dual?
	
	\mbox{}
	
	\begin{align*}
		\min_x \ & c^T x \\
		\mbox{t.q. } & Ax \geq b \\
		& x \geq 0
	\end{align*}
	
\end{frame}

\begin{frame}
	\frametitle{Dualité: forme standard}
	
	\begin{align*}
		\min_x \ & c^T x \\
		\mbox{t.q. } & Ax = b \\
		& x \geq 0
	\end{align*}
	
	revient à
	
	\begin{align*}
		\min_x \ & c^T x \\
		\mbox{t.q. } & Ax \geq b \\
		& -Ax \geq -b \\
		& x \geq 0
	\end{align*}
	
\end{frame}

\begin{frame}
	\frametitle{Dualité: forme standard}
	
	Le dual peut alors s'écrire
	\begin{align*}
		\max_{u, v} \ & u^T b - v^T b \\
		\mbox{t.q. } & u^T A - v^T A \leq c^T \\
		& u \geq 0 \\
		& v \geq 0
	\end{align*}
	ou, avec $\lambda = u - v$,
	\begin{align*}
		\max_{\lambda} \ & \lambda^T b \\
		\mbox{t.q. } & \lambda^T A \leq c^T \\
	\end{align*}
	
	Forme asymétrique: $\lambda \in \cR$.
	
\end{frame}


\begin{frame}
	\frametitle{Primal-dual conversion}
	
	\begin{center}
		\begin{tabular}{|c|c|}
			\hline
			\hline
			{\bf Minimisation} & {\bf Maximisation} \\
			\hline
			\hline
			Constraints & Variables \\
			$\geq$ & $\geq 0$ \\
			$\leq$ & $\leq 0$ \\
			$=$ & unconstrained \\
			\hline
			Variables & Constraints \\
			\hline
			$\geq 0$ & $\leq$ \\
			$\leq 0$ & $\geq$ \\
			unconstrained & $=$ \\
			\hline
		\end{tabular}
	\end{center}
	
\end{frame}

\begin{frame}
	\frametitle{Dualité faible}
	
	(Forme symétrique ou forme asymétrique -- forme standard)
	
	\mbox{}
	
	Si $x$ and $\lambda$ sont réalisables pour le primal et le dual, respectivement, alors
	\[
	c^T x \geq \lambda^T b
	\]
	
	\begin{proof}
		\[
		\lambda^T b \leq \lambda^TAx \leq c^Tx,
		\]
		pour $x \geq 0$, vu que $x$ est supposé realisable, et que du dual, $\lambda^T A \leq c^T$.
	\end{proof}
	
	Dès lors, l'objectif primal est une borne supérieure pour le dual, et vice-versa.
	
\end{frame}

\begin{frame}
	\frametitle{Corollaire}
	
	Si $x_0$ et $\lambda_0$ sont réalisables pour le primal et le dual, respectivement, et si
	\[
	c^T x_0 = \lambda_0^T b,
	\]
	alors $x_0$ et $\lambda_0$ sont optimaux pour leur problème respectif.
	
	\mbox{}
	
	Mais on n'a encore dit sur la réalisabilité d'un problème par rapport à l'autre!
	
\end{frame}

\begin{frame}
	\frametitle{Dualité forte}
	
	Si un des problèmes, primal ou dual, a une solution optimale finie, l'autre problème a aussi une solution optimale finie, et les valeurs correspondantes des fonctions objectifs sont égales. Si l'un des problèmes a un objectif non borné, l'autre problème n'a pas de solution réalisable.

\mbox{}

Si un programme est non réalisable, cela n'implique cependant pas que son dual soit non borné. Celui-ci peut être non réalisable.

\mbox{}

Le tableau ci-dessous synthétise les différents cas de figure possibles.

\begin{center}
	\begin{tabular}{|c||c|c|c|}
		\hline
		Primal / Dual & Borné & Non borné & Non réalisable \\
		\hline
		\hline
		Borné & possible & impossible & impossible \\
		\hline
		Non borné & impossible & impossible & possible \\
		\hline
		Non réalisable & impossible & possible & possible \\
		\hline
	\end{tabular}
\end{center}

\end{frame}

\begin{frame}
\frametitle{Optimalité et dualité}

L'optimalité peut se déduire des conditions KKT.

\mbox{}

En LP, nous n'avons pas besoin d'exiger une qualification de
contraintes pour appliquer les conditions KKT.

\mbox{}

Lagrangien:
\[
\mathcal{L} = c^Tx - \pi^T(Ax-b) - s^Tx.
\]

Conditions KKT: vecteurs de Lagrange $\pi$ et $s$ t.q.
\begin{align*}
A^T\pi + s &= c,\\
Ax &= b,\\
x &\geq 0,\\
s &\geq 0,\\
x_is_i &= 0,\ i=1,2,\ldots,n.
\end{align*}

\end{frame}

\begin{frame}
\frametitle{Problème dual}

Soit $(x^*, \pi^*, s^*)$ un vecteur satisfaisant les conditions
KKT. On a
\[
c^Tx^* = (A^T\pi^*+s^*)^Tx^* = (Ax^*)^T\pi^* = b^T\pi^*.
\]

Il est de plus facile de montrer que les conditions (nécessaires) KKT
sont suffisantes.

\mbox{}

{\red Problème dual}:
\[
\max_\pi b^T\pi, \mbox{ t.q. } A^T\pi \leq c,
\]
or, equivalently,
\[
\max_\pi b^T\pi, \mbox{ t.q. } A^T\pi +s = c,\ s \geq 0.
\]

\end{frame}

\end{document}